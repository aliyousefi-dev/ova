import{a as m,b as y,c as f,d as n,e as C,f as w,i as E,j as v}from"./chunk-CJ6VI6X7.js";import{c as h}from"./chunk-GJ22ZM4Y.js";import{a as p,c as g,r as d}from"./chunk-75WHGGER.js";import{a as c}from"./chunk-H2T75OZR.js";import{a as i,d as o}from"./chunk-4CLCTAJ7.js";var u=class{name="google-cast";target;#e;get cast(){return C()}mediaType(){return"video"}canPlay(e){return g&&!p&&d(e)}prompt(e){return o(this,null,function*(){let t,a,r;try{t=yield this.#r(e),this.#e||(this.#e=new cast.framework.RemotePlayer,new cast.framework.RemotePlayerController(this.#e)),a=e.player.createEvent("google-cast-prompt-open",{trigger:t}),e.player.dispatchEvent(a),this.#t(e,"connecting",a),yield this.#o(c(e.$props.googleCast)),e.$state.remotePlaybackInfo.set({deviceName:w()?.getCastDevice().friendlyName}),n()&&this.#t(e,"connected",a)}catch(s){let l=s instanceof Error?s:this.#a((s+"").toUpperCase(),"Prompt failed.");throw r=e.player.createEvent("google-cast-prompt-error",{detail:l,trigger:a??t,cancelable:!0}),e.player.dispatch(r),this.#t(e,n()?"connected":"disconnected",r),l}finally{e.player.dispatch("google-cast-prompt-close",{trigger:r??a??t})}})}load(e){return o(this,null,function*(){if(!this.#e)throw Error("[vidstack] google cast player was not initialized");return new(yield import("./chunk-MVFVJZSY.js")).GoogleCastProvider(this.#e,e)})}#r(e){return o(this,null,function*(){if(y())return;let t=e.player.createEvent("google-cast-load-start");e.player.dispatch(t),yield h(m()),yield customElements.whenDefined("google-cast-launcher");let a=e.player.createEvent("google-cast-loaded",{trigger:t});if(e.player.dispatch(a),!f())throw this.#a("CAST_NOT_AVAILABLE","Google Cast not available on this platform.");return a})}#o(e){return o(this,null,function*(){this.#s(e);let t=yield this.cast.requestSession();if(t)throw this.#a(t.toUpperCase(),v(t))})}#s(e){this.cast?.setOptions(i(i({},E()),e))}#t(e,t,a){let r={type:"google-cast",state:t};e.notify("remote-playback-change",r,a)}#a(e,t){let a=Error(t);return a.code=e,a}};export{u as GoogleCastLoader};
