<app-navbar></app-navbar>

<div class="flex h-[calc(100vh-2.5rem)] overflow-hidden flex-col">
  <!-- Main Content Area with Sidebar and Body -->
  <div class="flex flex-1 overflow-hidden">
    <!-- Sidebar -->
    <aside class="w-64 bg-base-200 flex flex-col p-4">
      <!-- Selected Repository Dropdown -->
      <div class="mb-6">
        <select
          class="select select-bordered w-full mb-2"
          [(ngModel)]="newRepoPath"
        >
          <option *ngFor="let repo of recentRepos" [value]="repo.path">
            {{ repo.name }} â€” {{ repo.path }}
          </option>
        </select>
      </div>

      <nav class="flex flex-col space-y-3">
        <button class="btn btn-ghost justify-start" (click)="selectedSection = 'home'">
          Core
        </button>
        
        <button class="btn btn-ghost justify-start" (click)="selectedSection = 'videos'">
          Videos
        </button>
        
        <!-- New Users Tab -->
        <button class="btn btn-ghost justify-start" (click)="selectedSection = 'users'">
          Users
        </button>
      
        <button class="btn btn-ghost justify-start" (click)="selectedSection = 'settings'">
          Settings
        </button>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 bg-base-100 overflow-auto">
      <!-- Play button and Show/Hide Logs button on top right -->
      <div class="flex justify-end items-center mb-4 bg-base-200 p-4 space-x-2">
        <button (click)="toggleLog()" class="btn btn-soft" aria-label="Toggle Logs">
          <lucide-icon
            [img]="showLogs ? eyeOff : eye"
            class="w-5 h-5"
          ></lucide-icon>
        </button>
        
        <button
          (click)="serve()"
          class="btn btn-primary btn-circle"
          title="Serve repository"
          aria-label="Serve"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
            viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M14.752 11.168l-6.518-3.75A.75.75 0 007 8.75v6.5a.75.75 0 001.234.625l6.518-3.75a.75.75 0 000-1.304z" />
          </svg>
        </button>
      </div>

<!-- Home Section -->
<div class="px-10" *ngIf="selectedSection === 'home'">
  <label class="input flex items-center space-x-3 mb-6 max-w-xl w-full">
    <span class="font-semibold text-base w-16">Path</span>
    <input
      type="text"
      [(ngModel)]="newRepoPath"
      placeholder="Enter new repository path"
      class="grow input input-bordered"
      aria-label="Repository Path"
    />
  </label>

  <div class="flex space-x-4 max-w-xl">
    <button (click)="runNewRepo()" class="btn btn-success flex-1">
      New Repository
    </button>
    <button (click)="chooseFolder()" class="btn btn-primary flex-1">
      Choose Folder
    </button>
  </div>
</div>



      <!-- Videos Section -->
      <div class="px-10" *ngIf="selectedSection === 'videos'">
        <!-- Replace below with your real videos content -->

        <div class="stats shadow">
          <div class="stat">
            <div class="stat-figure text-primary">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                class="inline-block h-8 w-8 stroke-current"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                ></path>
              </svg>
            </div>
            <div class="stat-title">Total Videos</div>
            <div class="stat-value text-primary">25.6K</div>
            <div class="stat-desc">21% more than last month</div>
          </div>
        
          <div class="stat">
            <div class="stat-figure text-secondary">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                class="inline-block h-8 w-8 stroke-current"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 10V3L4 14h7v7l9-11h-7z"
                ></path>
              </svg>
            </div>
            <div class="stat-title">Total Storage</div>
            <div class="stat-value text-secondary">2.6M</div>
            <div class="stat-desc">21% more than last month</div>
          </div>
        
          <div class="stat">
            <div class="stat-figure text-secondary">
              <div class="avatar avatar-online">
                <div class="w-16 rounded-full">
                  <img src="https://img.daisyui.com/images/profile/demo/anakeen@192.webp" />
                </div>
              </div>
            </div>
            <div class="stat-value">86%</div>
            <div class="stat-title">Tasks done</div>
            <div class="stat-desc text-secondary">31 tasks remaining</div>
          </div>
        </div>
      </div>

      <!-- Users Section -->
      <div class="px-10" *ngIf="selectedSection === 'users'">
        <h2 class="text-2xl font-bold mb-4">Users</h2>

        <!-- Example user list, replace with your actual user data and UI -->
        <ul class="divide-y divide-gray-200">
          <li *ngFor="let user of users" class="py-2 flex items-center justify-between">
            <div>
              <p class="font-semibold">{{ user.name }}</p>
              <p class="text-sm text-gray-500">{{ user.email }}</p>
            </div>
            <button class="btn btn-sm btn-outline">View</button>
          </li>
        </ul>
      </div>

      <!-- Settings Section -->
      <div class="px-10" *ngIf="selectedSection === 'settings'">
        <form (ngSubmit)="saveSettings()" class="space-y-6 max-w-md">
          <!-- Hostname -->
          <div class="form-control w-full flex items-center space-x-4">
            <label for="hostname" class="label font-semibold mb-0 w-32">
              Hostname
            </label>
            <input
              id="hostname"
              type="text"
              [(ngModel)]="settings.hostname"
              name="hostname"
              placeholder="localhost"
              class="input input-bordered flex-grow"
              required
              aria-describedby="hostnameHelp"
            />
          </div>
      
          <!-- Port -->
          <div class="form-control w-full flex items-center space-x-4">
            <label for="port" class="label font-semibold mb-0 w-32">
              Port
            </label>
            <input
              id="port"
              type="number"
              [(ngModel)]="settings.port"
              name="port"
              class="input input-bordered flex-grow"
              min="1"
              max="65535"
              required
              aria-describedby="portHelp"
            />
          </div>
      
          <!-- Enable Authentication Checkbox -->
          <div class="form-control w-full flex items-center space-x-4">
            <label for="enableAuthentication" class="label font-semibold mb-0 w-32">
              Enable Authentication
            </label>
            <input
              id="enableAuthentication"
              type="checkbox"
              [(ngModel)]="settings.enableAuthentication"
              name="enableAuthentication"
              class="checkbox"
            />
          </div>
      
          <!-- Save Button -->
          <button type="submit" class="btn btn-primary w-full">
            Save Settings
          </button>
        </form>
      </div>
      
    </main>
  </div>

  <!-- Resize handle for logs panel -->
  <div
    *ngIf="showLogs"
    class="resize-handle"
    (mousedown)="startResize($event)"
    (touchstart)="startResize($event)"
  ></div>

  <!-- Bottom Log Output Panel -->
  <div
    *ngIf="showLogs"
    class="relative bg-neutral-950 text-white text-sm overflow-auto font-mono border-t border-base-content"
    [style.height.px]="logsHeight"
    style="padding: 1rem;"
  >
    <!-- Copy Button -->
    <button
      (click)="copyLogs()"
      class="btn btn-xs btn-ghost absolute top-2 right-2"
      aria-label="Copy logs to clipboard"
    >
      Copy
    </button>

    <strong class="text-emerald-400">CLI Output:</strong>
    <pre class="whitespace-pre-wrap break-words">{{ cliOutput }}</pre>
  </div>
</div>
