import{d as s,e as T}from"./chunk-H6PMGWUE.js";import{a as v,b as w}from"./chunk-F6R4ESLF.js";import{h as M,i as a,j as u}from"./chunk-75WHGGER.js";import{e as k,f as o,r as x,t as y,u as P}from"./chunk-H2T75OZR.js";import{d as n}from"./chunk-4CLCTAJ7.js";var h=class{#t;#i;constructor(t,e){this.#t=t,this.#i=e,t.textTracks.onaddtrack=this.#e.bind(this),o(this.#r.bind(this))}#e(t){let e=t.track;if(!e||I(this.#t,e))return;let i=new T({id:e.id,kind:e.kind,label:e.label??"",language:e.language,type:"vtt"});i[s.native]={track:e},i[s.readyState]=2,i[s.nativeHLS]=!0;let m=0,g=E=>{if(e.cues)for(let c=m;c<e.cues.length;c++)i.addCue(e.cues[c],E),m++};g(t),e.oncuechange=g,this.#i.textTracks.add(i,t),i.setMode(e.mode,t)}#r(){this.#t.textTracks.onaddtrack=null;for(let t of this.#i.textTracks){let e=t[s.native]?.track;e?.oncuechange&&(e.oncuechange=null)}}};function I(r,t){return Array.from(r.children).find(e=>e.track===t)}var d=class{#t;#i;constructor(t,e){this.#t=t,this.#i=e,new P(t).add("enterpictureinpicture",this.#e.bind(this)).add("leavepictureinpicture",this.#r.bind(this))}get active(){return document.pictureInPictureElement===this.#t}get supported(){return a(this.#t)}enter(){return n(this,null,function*(){return this.#t.requestPictureInPicture()})}exit(){return document.exitPictureInPicture()}#e(t){this.#n(!0,t)}#r(t){this.#n(!1,t)}#n=(t,e)=>{this.#i.notify("picture-in-picture-change",t,e)}},p=class{#t;#i;#e="inline";get mode(){return this.#e}constructor(t,e){this.#t=t,this.#i=e,y(t,"webkitpresentationmodechanged",this.#r.bind(this))}get supported(){return u(this.#t)}setPresentationMode(t){return n(this,null,function*(){this.#e!==t&&this.#t.webkitSetPresentationMode(t)})}#r(t){let e=this.#e;this.#e=this.#t.webkitPresentationMode,this.#i.player?.dispatch(new x("video-presentation-change",{detail:this.#e,trigger:t})),["fullscreen","picture-in-picture"].forEach(i=>{(this.#e===i||e===i)&&this.#i.notify(`${i}-change`,this.#e===i,t)})}},l=class{#t;get active(){return this.#t.mode==="fullscreen"}get supported(){return this.#t.supported}constructor(t){this.#t=t}enter(){return n(this,null,function*(){this.#t.setPresentationMode("fullscreen")})}exit(){return n(this,null,function*(){this.#t.setPresentationMode("inline")})}},f=class{#t;get active(){return this.#t.mode==="picture-in-picture"}get supported(){return this.#t.supported}constructor(t){this.#t=t}enter(){return n(this,null,function*(){this.#t.setPresentationMode("picture-in-picture")})}exit(){return n(this,null,function*(){this.#t.setPresentationMode("inline")})}},b=class extends v{$$PROVIDER_TYPE="VIDEO";get type(){return"video"}airPlay;fullscreen;pictureInPicture;constructor(t,e){super(t,e),k(()=>{if(this.airPlay=new w(t,e),u(t)){let i=new p(t,e);this.fullscreen=new l(i),this.pictureInPicture=new f(i)}else a(t)&&(this.pictureInPicture=new d(t,e))},this.scope)}setup(){super.setup(),M(this.video)&&new h(this.video,this.ctx),this.ctx.textRenderers.attachVideo(this.video),o(()=>{this.ctx.textRenderers.attachVideo(null)}),this.type==="video"&&this.ctx.notify("provider-setup",this)}get video(){return this.media}};export{b as a};
