<app-top-nav-bar [title]="'Discover'"></app-top-nav-bar>

<app-search-bar
  [value]="searchTerm"
  (valueChange)="onSearchTermChange($event)"
  placeholder="Search videos..."
></app-search-bar>

<!-- 📦 Filters & Options -->
<div class="max-w-7xl mx-auto px-4 mt-6 space-y-4">
  <!-- Controls Row -->
<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">



  <!-- 🟨 Row 3: Resolution Filter -->
  <div class="w-full md:w-auto">
    <div class="flex flex-wrap items-center gap-2">
      <input
        class="btn btn-sm"
        type="radio"
        name="resolution"
        aria-label="All"
        [checked]="resolutionFilter === ''"
        (click)="setResolutionFilter('')"
      />
      <input
        class="btn btn-sm"
        type="radio"
        name="resolution"
        aria-label="720p"
        [checked]="resolutionFilter === '720p'"
        (click)="setResolutionFilter('720p')"
      />
      <input
        class="btn btn-sm"
        type="radio"
        name="resolution"
        aria-label="1080p"
        [checked]="resolutionFilter === '1080p'"
        (click)="setResolutionFilter('1080p')"
      />
      <input
        class="btn btn-sm"
        type="radio"
        name="resolution"
        aria-label="4K"
        [checked]="resolutionFilter === '4K'"
        (click)="setResolutionFilter('4K')"
      />
    </div>
  </div>

<!-- 🟩 Duration Filter -->
<div class="w-full md:w-auto">
  <div class="flex flex-wrap items-center gap-2">
    <input
      class="btn btn-sm"
      type="radio"
      name="duration"
      aria-label="All"
      [checked]="durationFilter === ''"
      (click)="setDurationFilter('')"
    />
    <input
      class="btn btn-sm"
      type="radio"
      name="duration"
      aria-label="≤ 5 min"
      [checked]="durationFilter === 'short'"
      (click)="setDurationFilter('short')"
    />
    <input
      class="btn btn-sm"
      type="radio"
      name="duration"
      aria-label="5 – 15 min"
      [checked]="durationFilter === 'medium'"
      (click)="setDurationFilter('medium')"
    />
    <input
      class="btn btn-sm"
      type="radio"
      name="duration"
      aria-label="15 – 30 min"
      [checked]="durationFilter === 'long'"
      (click)="setDurationFilter('long')"
    />
    <input
      class="btn btn-sm"
      type="radio"
      name="duration"
      aria-label="30 – 60 min"
      [checked]="durationFilter === 'veryLong'"
      (click)="setDurationFilter('veryLong')"
    />
    <input
      class="btn btn-sm"
      type="radio"
      name="duration"
      aria-label="> 60 min"
      [checked]="durationFilter === 'extraLong'"
      (click)="setDurationFilter('extraLong')"
    />
  </div>
</div>





  <!-- 🟩 Row 2: Tag Toggle -->
  <div class="w-full md:w-auto">
    <div class="flex items-center gap-2">
      <label class="label cursor-pointer">
        <span class="label-text text-sm font-medium">Tag Only Search</span>
<input
  type="checkbox"
  class="toggle toggle-sm"
  [(ngModel)]="tagSearchEnabled"
  (change)="onTagSearchToggle()"
/>
      </label>
    </div>
  </div>

  <!-- 🟦 Row 1: Sort -->
  <div class="w-full md:w-auto">
    <div class="flex items-center gap-2">
      <label for="sort" class="text-sm font-medium">Sort by:</label>
      <select
        id="sort"
        [(ngModel)]="sortOption"
        class="select select-sm select-bordered w-40"
      >
        <option value="titleAsc">Title (A–Z)</option>
        <option value="titleDesc">Title (Z–A)</option>
        <option value="durationAsc">Duration (Short → Long)</option>
        <option value="durationDesc">Duration (Long → Short)</option>
        <option value="newest">Newest</option>
        <option value="oldest">Oldest</option>
      </select>
    </div>
  </div>

</div>

<div class="flex flex-wrap items-center justify-between  mt-20 w-full">

  <!-- ✅ Result Count -->
  <div class="text-sm md:text-base">
    Result: {{ totalCount }} videos
  </div>

  <!-- ✅ Top Pagination -->
<!-- Add horizontal scroll wrapper -->
<div class="pagination-wrapper overflow-x-auto mt-4">
  <div *ngIf="totalPages > 1 && !loading" class="overflow-x-auto">
    <div class="join whitespace-nowrap w-max mx-auto">
      <button
        *ngFor="let _ of [].constructor(totalPages); let i = index"
        class="join-item btn btn-sm"
        [class.btn-active]="currentPage === i + 1"
        (click)="goToPage(i + 1)"
      >
        {{ i + 1 }}
      </button>
    </div>
  </div>
</div>


</div>


<!-- 🎥 Video Grid -->
<div class="max-w-7xl mx-auto mt-6 pb-2">
  <p *ngIf="loading" class=" font-medium text-center">Loading videos...</p>

  <app-video-grid
    *ngIf="!loading && filteredVideos.length > 0"
    [videos]="filteredVideos"
  ></app-video-grid>

<!-- 🔽 Bottom Pagination -->
<div class="w-full   mb-30 overflow-x-auto">
  <div *ngIf="totalPages > 1 && !loading" class="w-max mx-auto">
    <div class="join whitespace-nowrap">
      <button
        *ngFor="let _ of [].constructor(totalPages); let i = index"
        class="join-item btn btn-sm"
        [class.btn-active]="currentPage === i + 1"
        (click)="goToPage(i + 1)"
      >
        {{ i + 1 }}
      </button>
    </div>
  </div>
</div>



  <!-- 🔍 No Results Messages -->
  <p *ngIf="!loading && !searchTerm" class=" text-center mt-4">
    Please enter a search term to find videos.
  </p>

  <p *ngIf="!loading && filteredVideos.length === 0 && searchTerm" class=" text-center mt-4">
    No videos found for "{{ searchTerm }}"
  </p>
</div>
